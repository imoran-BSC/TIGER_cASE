/*
 *  ALLELIC IMBALANCE COMMON UTILS -HEADER-
 *
 *  Contains the hard thresholds and parameters used through the study
 *  of allelic imbalance, as global variables.
 *  Also contains the declarations of common classes and functions
 *  used in various allelic imbalance scripts
 *
 *  Writen by Ignasi Moran
 */

using namespace std;

const unsigned min_num_hets = 3,  // Min num of genotyped Hets in order to consider the SNP
  min_total_count = 15,  // Min amount of total reads for coverage threshold consideration
  min_num_clon_reads = 10, // Min number of clonal reads per allele to consider the AR
  min_num_consistent = 3;  // Min num of samples pointing in the same direction to consider
const double err_read_pctg = 0.01,  // 1% as the max threshold for error reads accepted
  min_pval = 1e-15,  // Minimum possible (non binom) pval, binom gets blunted to this for Fisher's
  imba_het_threshold = 0.05,  // Min/max allowed AR values for coverage threshold
  binom_pval_threshold = 0.001,  // Minimum threshold to consider binom pvals as significant
  qnorm_vals[] = {  // Tabulates the values of qnorm( 1 - pval ) for pval = 10^-(0:1530/100) - extracted from R
    -8.014015949,-1.999765810,-1.695319498,-1.500475024,-1.353242032,
    -1.233208128,-1.130957880,-1.041326755,-0.961158543,-0.888375188,
    -0.821531603,-0.759579851,-0.701734345,-0.647390076,-0.596070576,
    -0.547393484,-0.501046982,-0.456773230,-0.414356415,-0.373613966,
    -0.334389965,-0.296550121,-0.259977891,-0.224571434,-0.190241203,
    -0.156908007,-0.124501450,-0.092958655,-0.062223210,-0.032244295,
    -0.002975958,0.025623504,0.053592057,0.080964377,0.107772221,
    0.134044755,0.159808835,0.185089244,0.209908911,0.234289089,
    0.258249522,0.281808582,0.304983403,0.327789988,0.350243305,
    0.372357385,0.394145391,0.415619695,0.436791943,0.457673104,
    0.478273532,0.498603007,0.518670776,0.538485598,0.558055772,
    0.577389173,0.596493282,0.615375207,0.634041715,0.652499250,
    0.670753952,0.688811682,0.706678033,0.724358350,0.741857743,
    0.759181104,0.776333116,0.793318265,0.810140854,0.826805012,
    0.843314701,0.859673729,0.875885756,0.891954301,0.907882751,
    0.923674367,0.939332289,0.954859545,0.970259054,0.985533633,
    1.000685999,1.015718777,1.030634503,1.045435628,1.060124520,
    1.074703472,1.089174701,1.103540356,1.117802514,1.131963190,
    1.146024337,1.159987847,1.173855556,1.187629244,1.201310641,
    1.214901423,1.228403221,1.241817618,1.255146151,1.268390315,
    1.281551566,1.294631315,1.307630941,1.320551780,1.333395136,
    1.346162278,1.358854441,1.371472830,1.384018617,1.396492946,
    1.408896932,1.421231661,1.433498193,1.445697563,1.457830780,
    1.469898829,1.481902671,1.493843247,1.505721472,1.517538242,
    1.529294434,1.540990902,1.552628482,1.564207992,1.575730230,
    1.587195980,1.598606004,1.609961052,1.621261855,1.632509130,
    1.643703577,1.654845884,1.665936722,1.676976751,1.687966614,
    1.698906944,1.709798360,1.720641468,1.731436863,1.742185127,
    1.752886833,1.763542541,1.774152799,1.784718148,1.795239115,
    1.805716219,1.816149970,1.826540868,1.836889401,1.847196052,
    1.857461293,1.867685588,1.877869393,1.888013154,1.898117312,
    1.908182299,1.918208538,1.928196446,1.938146433,1.948058902,
    1.957934248,1.967772859,1.977575120,1.987341404,1.997072083,
    2.006767520,2.016428073,2.026054092,2.035645926,2.045203913,
    2.054728389,2.064219684,2.073678122,2.083104023,2.092497701,
    2.101859466,2.111189621,2.120488468,2.129756301,2.138993412,
    2.148200086,2.157376607,2.166523253,2.175640296,2.184728007,
    2.193786652,2.202816492,2.211817786,2.220790789,2.229735750,
    2.238652917,2.247542535,2.256404842,2.265240076,2.274048470,
    2.282830255,2.291585657,2.300314901,2.309018207,2.317695793,
    2.326347874,2.334974662,2.343576367,2.352153194,2.360705347,
    2.369233027,2.377736432,2.386215759,2.394671199,2.403102944,
    2.411511182,2.419896098,2.428257876,2.436596698,2.444912740,
    2.453206181,2.461477194,2.469725952,2.477952624,2.486157378,
    2.494340380,2.502501794,2.510641782,2.518760503,2.526858115,
    2.534934775,2.542990635,2.551025849,2.559040568,2.567034939,
    2.575009109,2.582963224,2.590897428,2.598811862,2.606706666,
    2.614581980,2.622437939,2.630274680,2.638092337,2.645891041,
    2.653670924,2.661432115,2.669174743,2.676898933,2.684604812,
    2.692292502,2.699962126,2.707613806,2.715247661,2.722863809,
    2.730462369,2.738043455,2.745607183,2.753153665,2.760683015,
    2.768195344,2.775690761,2.783169375,2.790631294,2.798076624,
    2.805505470,2.812917938,2.820314130,2.827694149,2.835058095,
    2.842406069,2.849738170,2.857054496,2.864355144,2.871640210,
    2.878909790,2.886163978,2.893402866,2.900626548,2.907835116,
    2.915028658,2.922207266,2.929371028,2.936520033,2.943654366,
    2.950774115,2.957879366,2.964970201,2.972046707,2.979108965,
    2.986157058,2.993191067,3.000211073,3.007217157,3.014209397,
    3.021187872,3.028152659,3.035103837,3.042041480,3.048965665,
    3.055876467,3.062773960,3.069658218,3.076529314,3.083387319,
    3.090232306,3.097064346,3.103883509,3.110689864,3.117483482,
    3.124264430,3.131032777,3.137788589,3.144531934,3.151262878,
    3.157981486,3.164687824,3.171381955,3.178063945,3.184733855,
    3.191391750,3.198037691,3.204671741,3.211293960,3.217904409,
    3.224503149,3.231090239,3.237665738,3.244229706,3.250782200,
    3.257323278,3.263852998,3.270371417,3.276878590,3.283374574,
    3.289859425,3.296333197,3.302795944,3.309247722,3.315688583,
    3.322118581,3.328537769,3.334946200,3.341343924,3.347730995,
    3.354107463,3.360473378,3.366828792,3.373173754,3.379508314,
    3.385832522,3.392146425,3.398450073,3.404743513,3.411026794,
    3.417299962,3.423563066,3.429816150,3.436059263,3.442292449,
    3.448515754,3.454729224,3.460932904,3.467126837,3.473311069,
    3.479485643,3.485650603,3.491805992,3.497951854,3.504088230,
    3.510215163,3.516332695,3.522440868,3.528539724,3.534629303,
    3.540709646,3.546780795,3.552842788,3.558895666,3.564939469,
    3.570974236,3.577000006,3.583016818,3.589024711,3.595023723,
    3.601013891,3.606995254,3.612967849,3.618931714,3.624886885,
    3.630833399,3.636771293,3.642700602,3.648621363,3.654533611,
    3.660437382,3.666332711,3.672219634,3.678098184,3.683968397,
    3.689830306,3.695683946,3.701529350,3.707366553,3.713195587,
    3.719016485,3.724829282,3.730634008,3.736430698,3.742219382,
    3.748000094,3.753772865,3.759537726,3.765294709,3.771043846,
    3.776785168,3.782518704,3.788244487,3.793962545,3.799672911,
    3.805375613,3.811070681,3.816758146,3.822438036,3.828110381,
    3.833775211,3.839432553,3.845082437,3.850724891,3.856359944,
    3.861987624,3.867607959,3.873220977,3.878826705,3.884425171,
    3.890016402,3.895600426,3.901177269,3.906746958,3.912309521,
    3.917864983,3.923413371,3.928954711,3.934489029,3.940016351,
    3.945536703,3.951050110,3.956556598,3.962056191,3.967548916,
    3.973034796,3.978513858,3.983986125,3.989451621,3.994910373,
    4.000362402,4.005807735,4.011246393,4.016678403,4.022103786,
    4.027522567,4.032934769,4.038340415,4.043739529,4.049132132,
    4.054518249,4.059897902,4.065271114,4.070637906,4.075998302,
    4.081352323,4.086699991,4.092041329,4.097376359,4.102705101,
    4.108027579,4.113343812,4.118653823,4.123957632,4.129255261,
    4.134546731,4.139832062,4.145111276,4.150384393,4.155651434,
    4.160912418,4.166167366,4.171416299,4.176659237,4.181896199,
    4.187127205,4.192352275,4.197571429,4.202784686,4.207992066,
    4.213193588,4.218389271,4.223579135,4.228763197,4.233941478,
    4.239113996,4.244280770,4.249441818,4.254597160,4.259746812,
    4.264890794,4.270029124,4.275161820,4.280288899,4.285410381,
    4.290526282,4.295636621,4.300741415,4.305840682,4.310934439,
    4.316022704,4.321105493,4.326182824,4.331254715,4.336321182,
    4.341382242,4.346437911,4.351488208,4.356533148,4.361572748,
    4.366607024,4.371635994,4.376659672,4.381678077,4.386691223,
    4.391699126,4.396701804,4.401699271,4.406691544,4.411678638,
    4.416660569,4.421637353,4.426609006,4.431575541,4.436536976,
    4.441493326,4.446444605,4.451390828,4.456332012,4.461268171,
    4.466199319,4.471125472,4.476046644,4.480962851,4.485874106,
    4.490780425,4.495681822,4.500578311,4.505469907,4.510356624,
    4.515238477,4.520115478,4.524987644,4.529854986,4.534717521,
    4.539575260,4.544428219,4.549276411,4.554119850,4.558958549,
    4.563792522,4.568621782,4.573446343,4.578266219,4.583081422,
    4.587891965,4.592697863,4.597499128,4.602295773,4.607087811,
    4.611875255,4.616658119,4.621436414,4.626210154,4.630979351,
    4.635744018,4.640504168,4.645259813,4.650010965,4.654757638,
    4.659499843,4.664237592,4.668970899,4.673699775,4.678424232,
    4.683144283,4.687859939,4.692571212,4.697278115,4.701980659,
    4.706678856,4.711372718,4.716062257,4.720747483,4.725428410,
    4.730105048,4.734777408,4.739445504,4.744109344,4.748768942,
    4.753424309,4.758075455,4.762722392,4.767365131,4.772003683,
    4.776638060,4.781268271,4.785894329,4.790516244,4.795134028,
    4.799747690,4.804357241,4.808962693,4.813564056,4.818161341,
    4.822754558,4.827343717,4.831928831,4.836509907,4.841086959,
    4.845659994,4.850229025,4.854794061,4.859355112,4.863912189,
    4.868465302,4.873014460,4.877559675,4.882100956,4.886638312,
    4.891171755,4.895701293,4.900226938,4.904748697,4.909266582,
    4.913780602,4.918290767,4.922797086,4.927299569,4.931798226,
    4.936293066,4.940784099,4.945271333,4.949754780,4.954234447,
    4.958710344,4.963182481,4.967650867,4.972115511,4.976576422,
    4.981033610,4.985487083,4.989936851,4.994382922,4.998825306,
    5.003264012,5.007699049,5.012130425,5.016558149,5.020982231,
    5.025402678,5.029819501,5.034232707,5.038642305,5.043048304,
    5.047450712,5.051849539,5.056244792,5.060636480,5.065024612,
    5.069409196,5.073790241,5.078167755,5.082541745,5.086912222,
    5.091279192,5.095642665,5.100002648,5.104359149,5.108712177,
    5.113061740,5.117407846,5.121750504,5.126089720,5.130425503,
    5.134757862,5.139086803,5.143412336,5.147734467,5.152053205,
    5.156368557,5.160680532,5.164989137,5.169294380,5.173596268,
    5.177894810,5.182190012,5.186481883,5.190770430,5.195055660,
    5.199337582,5.203616203,5.207891529,5.212163570,5.216432331,
    5.220697821,5.224960046,5.229219015,5.233474735,5.237727212,
    5.241976454,5.246222468,5.250465262,5.254704843,5.258941217,
    5.263174392,5.267404375,5.271631174,5.275854795,5.280075244,
    5.284292530,5.288506659,5.292717639,5.296925475,5.301130175,
    5.305331746,5.309530195,5.313725528,5.317917753,5.322106875,
    5.326292903,5.330475842,5.334655699,5.338832481,5.343006195,
    5.347176847,5.351344443,5.355508992,5.359670498,5.363828969,
    5.367984410,5.372136829,5.376286232,5.380432625,5.384576016,
    5.388716409,5.392853813,5.396988232,5.401119673,5.405248143,
    5.409373648,5.413496194,5.417615788,5.421732435,5.425846142,
    5.429956915,5.434064760,5.438169684,5.442271692,5.446370790,
    5.450466985,5.454560283,5.458650689,5.462738211,5.466822853,
    5.470904621,5.474983522,5.479059562,5.483132745,5.487203080,
    5.491270571,5.495335224,5.499397043,5.503456038,5.507512212,
    5.511565571,5.515616121,5.519663867,5.523708816,5.527750974,
    5.531790345,5.535826936,5.539860752,5.543891798,5.547920081,
    5.551945606,5.555968378,5.559988403,5.564005687,5.568020235,
    5.572032053,5.576041144,5.580047518,5.584051176,5.588052127,
    5.592050372,5.596045921,5.600038777,5.604028946,5.608016433,
    5.612001243,5.615983383,5.619962857,5.623939670,5.627913825,
    5.631885333,5.635854195,5.639820417,5.643784004,5.647744962,
    5.651703294,5.655659007,5.659612107,5.663562597,5.667510486,
    5.671455774,5.675398466,5.679338570,5.683276093,5.687211034,
    5.691143403,5.695073203,5.699000435,5.702925114,5.706847234,
    5.710766806,5.714683837,5.718598324,5.722510277,5.726419702,
    5.730326602,5.734230982,5.738132846,5.742032200,5.745929046,
    5.749823393,5.753715242,5.757604602,5.761491472,5.765375863,
    5.769257773,5.773137213,5.777014184,5.780888690,5.784760735,
    5.788630329,5.792497472,5.796362172,5.800224427,5.804084251,
    5.807941638,5.811796599,5.815649140,5.819499259,5.823346973,
    5.827192267,5.831035161,5.834875659,5.838713754,5.842549461,
    5.846382778,5.850213720,5.854042276,5.857868460,5.861692278,
    5.865513727,5.869332812,5.873149541,5.876963920,5.880775960,
    5.884585645,5.888392989,5.892198007,5.896000683,5.899801041,
    5.903599070,5.907394787,5.911188182,5.914979271,5.918768050,
    5.922554532,5.926338716,5.930120604,5.933900206,5.937677521,
    5.941452555,5.945225310,5.948995797,5.952764006,5.956529957,
    5.960293639,5.964055067,5.967814249,5.971571177,5.975325860,
    5.979078290,5.982828490,5.986576465,5.990322215,5.994065720,
    5.997807020,6.001546097,6.005282943,6.009017612,6.012750056,
    6.016480288,6.020208329,6.023934185,6.027657847,6.031379328,
    6.035098601,6.038815728,6.042530660,6.046243415,6.049954008,
    6.053662430,6.057368716,6.061072819,6.064774763,6.068474592,
    6.072172234,6.075867769,6.079561158,6.083252402,6.086941519,
    6.090628514,6.094313371,6.097996124,6.101676750,6.105355241,
    6.109031666,6.112705970,6.116378136,6.120048233,6.123716265,
    6.127382164,6.131045984,6.134707706,6.138367356,6.142024965,
    6.145680436,6.149333892,6.152985235,6.156634544,6.160281811,
    6.163926971,6.167570101,6.171211177,6.174850218,6.178487184,
    6.182122185,6.185755052,6.189385932,6.193014797,6.196641601,
    6.200266402,6.203889182,6.207509968,6.211128703,6.214745437,
    6.218360202,6.221972938,6.225583623,6.229192356,6.232799136,
    6.236403855,6.240006677,6.243607422,6.247206187,6.250803041,
    6.254397842,6.257990749,6.261581708,6.265170611,6.268757577,
    6.272342589,6.275925671,6.279506794,6.283085973,6.286663161,
    6.290238464,6.293811817,6.297383197,6.300952741,6.304520284,
    6.308085815,6.311649493,6.315211279,6.318771177,6.322329105,
    6.325885153,6.329439186,6.332991387,6.336541710,6.340090148,
    6.343636742,6.347181265,6.350723998,6.354264798,6.357803893,
    6.361340890,6.364876104,6.368409391,6.371940818,6.375470505,
    6.378998243,6.382524049,6.386047981,6.389570151,6.393090306,
    6.396608857,6.400125423,6.403640078,6.407152949,6.410663986,
    6.414173178,6.417680558,6.421186207,6.424689744,6.428191586,
    6.431691695,6.435190076,6.438686496,6.442181035,6.445673822,
    6.449164743,6.452654026,6.456141336,6.459626673,6.463110736,
    6.466592658,6.470072563,6.473550983,6.477027824,6.480502664,
    6.483975457,6.487446585,6.490916113,6.494383759,6.497849667,
    6.501314037,6.504776275,6.508237093,6.511695964,6.515152819,
    6.518608562,6.522061826,6.525513615,6.528964067,6.532412347,
    6.535858640,6.539303728,6.542746860,6.546188383,6.549628147,
    6.553066029,6.556501939,6.559936441,6.563369561,6.566800087,
    6.570229370,6.573656910,6.577082895,6.580507569,6.583929806,
    6.587350627,6.590769683,6.594186641,6.597602752,6.601017011,
    6.604429185,6.607839907,6.611248189,6.614655639,6.618061352,
    6.621465305,6.624867515,6.628268044,6.631667004,6.635063549,
    6.638459899,6.641853239,6.645245938,6.648636210,6.652024404,
    6.655412102,6.658797531,6.662181211,6.665563756,6.668944613,
    6.672323221,6.675700335,6.679076821,6.682450900,6.685823503,
    6.689194239,6.692562729,6.695930113,6.699296134,6.702660551,
    6.706023143,6.709383712,6.712743781,6.716101585,6.719457015,
    6.722811808,6.726166050,6.729516079,6.732865702,6.736215154,
    6.739560667,6.742906478,6.746248761,6.749592071,6.752932534,
    6.756270506,6.759606421,6.762943175,6.766276677,6.769609960,
    6.772938747,6.776268819,6.779595891,6.782923486,6.786247139,
    6.789570563,6.792892029,6.796209690,6.799530717,6.802847398,
    6.806160909,6.809475845,6.812787263,6.816096622,6.819405564,
    6.822712355,6.826018794,6.829323150,6.832627395,6.835925910,
    6.839228584,6.842525829,6.845823927,6.849116961,6.852411626,
    6.855701866,6.858994826,6.862284316,6.865568397,6.868854792,
    6.872141967,6.875423158,6.878706733,6.881985804,6.885263846,
    6.888539096,6.891815406,6.895091157,6.898364620,6.901633943,
    6.904903427,6.908171397,6.911436060,6.914702215,6.917968282,
    6.921225540,6.924486068,6.927748410,6.931003490,6.934264498,
    6.937514434,6.940766935,6.944020503,6.947273531,6.950524298,
    6.953770966,6.957011572,6.960262442,6.963503770,6.966742850,
    6.969987710,6.973226994,6.976458636,6.979690984,6.982933207,
    6.986162249,6.989398091,6.992627990,6.995849862,6.999073562,
    7.002309906,7.005532831,7.008752654,7.011967496,7.015188873,
    7.018415575,7.021632157,7.024850714,7.028054918,7.031272390,
    7.034486910,7.037696605,7.040899479,7.044109968,7.047309999,
    7.050514522,7.053722193,7.056931570,7.060122556,7.063330164,
    7.066515080,7.069713777,7.072905260,7.076108141,7.079300313,
    7.082479372,7.085687209,7.088855974,7.092051053,7.095225069,
    7.098423560,7.101596813,7.104792320,7.107957913,7.111143120,
    7.114320426,7.117487631,7.120670888,7.123840522,7.127023747,
    7.130189366,7.133334510,7.136519935,7.139681544,7.142849406,
    7.146022315,7.149164054,7.152342261,7.155484765,7.158662186,
    7.161798862,7.164968522,7.168131834,7.171286702,7.174430896,
    7.177562046,7.180721407,7.183864535,7.186988668,7.190137716,
    7.193311794,7.196461969,7.199584919,7.202728415,7.205839813,
    7.208968923,7.212115371,7.215278735,7.218401113,7.221536749,
    7.224624876,7.227783476,7.230890145,7.234068209,7.237189466,
    7.240315574,7.243376454,7.246506740,7.249637692,7.252767722,
    7.255895129,7.259018093,7.262134673,7.265242803,7.268340281,
    7.271424772,7.274580034,7.277632909,7.280755157,7.283857713,
    7.286937590,7.290088179,7.293213996,7.296311640,7.299377530,
    7.302513606,7.305614981,7.308677601,7.311810347,7.314900726,
    7.317944165,7.321056934,7.324118399,7.327250088,7.330325664,
    7.333339617,7.336421693,7.339575076,7.342661220,7.345673791,
    7.348754540,7.351906655,7.354978144,7.357961764,7.361174830,
    7.364133033,7.367327114,7.370250114,7.373415266,7.376473966,
    7.379603273,7.382616018,7.385697300,7.388651108,7.391670823,
    7.394759483,7.397920340,7.400938685,7.404026000,7.406957390,
    7.410187121,7.413256985,7.416154084,7.419364485,7.422397375,
    7.425238807,7.428408491,7.431381090,7.434420843,7.437530881,
    7.440714565,7.443675760,7.446703700,7.449801493,7.452651979,
    7.455891869,7.458876231,7.461928540,7.465051993,7.467890887,
    7.470791272,7.474131138,7.477171556,7.479889830,7.483065651,
    7.485907787,7.489231757,7.492209696,7.495255597,7.498372662,
    7.501103673,7.504362215,7.507220107,7.510140662,7.513126715,
    7.516181300,7.519307665,7.522509299,7.525237519,7.528022927,
    7.531444396,7.534364550,7.537350400,7.540404997,7.543531614,
    7.546087110,7.549352382,7.552023818,7.555440738,7.558239241,
    7.561098219,7.564020368,7.567008568,7.570065903,7.573195677,
    7.576401440,7.578857915,7.582206017,7.585641333,7.588277872,
    7.590968239,7.593714697,7.597468084,7.600355074,7.603306835,
    7.606326366,7.609416883,7.611518356,7.614734972,7.618032357,
    7.621414710,7.623719042,7.627253271,7.629663485,7.633364007,
    7.635890397,7.638466484,7.641094282,7.645137647,7.647904371,
    7.650730905,7.653619917,7.656574257,7.659596974,7.662691338,
    7.665860858,7.669109311,7.670764396,7.674138974,7.677603273,
    7.679370597,7.682978879,7.686690050,7.688586102,7.692463207,
    7.694445998,7.698504715,7.700582639,7.702694354,7.707023720,
    7.709243802,7.711502545,7.716141613,7.718524936,7.720952925,
    7.723427301,7.728522616,7.731147539,7.733826837,7.736562830,
    7.739357991,7.742214959,7.745136553,7.748125791,7.751185908,
    7.754320376,7.757532932,7.760827601,7.760827601,7.764208729,
    7.767681015,7.771249557,7.774919892,7.778698051,7.778698051,
    7.782590618,7.786604801,7.786604801,7.790748516,7.795030476,
    7.799460311,7.799460311,7.804048692,7.804048692,7.808807497,
    7.813749990,7.813749990,7.818891056,7.818891056,7.824247467,
    7.824247467,7.829838223,7.829838223,7.835684964,7.835684964,
    7.841812480,7.841812480,7.848249359,7.848249359,7.855028804,
    7.855028804,7.855028804,7.862189685,7.862189685,7.869777911,
    7.869777911,7.869777911,7.877848237,7.877848237,7.877848237,
    7.886466704,7.886466704,7.886466704,7.895713973,7.895713973,
    7.895713973,7.905689996,7.905689996,7.905689996,7.905689996,
    7.916520712,7.916520712,7.916520712,7.916520712,7.928367943,
    7.928367943,7.928367943,7.928367943,7.941444487,7.941444487,
    7.941444487,7.941444487,7.941444487,7.956038125,7.956038125,
    7.956038125,7.956038125,7.956038125,7.972551664,7.972551664,
    7.972551664,7.972551664,7.972551664,7.972551664,7.972551664,
    7.991573950,7.991573950,7.991573950,7.991573950,7.991573950,
    7.991573950,7.991573950,8.014015949,8.014015949,8.014015949,
    8.014015949,8.014015949,8.014015949,8.014015949,8.014015949,
    8.014015949};

const unsigned qnorm_length = sizeof( qnorm_vals )/sizeof(double);

extern unsigned num_rnaseq_samples, num_genoty_samples;  // Number of samples to process

// Pre-declarations of stuff for linkage

class class_fstream;
class class_snp;

/*
 *   FUNCTION DECLARATIONS
 */

// Go FIRST since some classes use these functions

double funct_get_median( vector<double>& vec );
bool   funct_coverage_test( const class_snp& snp, const unsigned& indx );
double funct_calc_fisher( vector<double*>& pv );
double funct_calc_zvalue( vector<double*>& pv, vector<double*>& ratios,
  vector<int*>& read_counts, int with_direction = 1 );
double funct_qnorm( const double& pv );
double funct_zpval( double& zval );


/*
 *   CLASS DECLARATIONS
 */

class class_sampledata
{  // refc, altc, errc, imba, pval, genoty
public:
  int refc, altc, errc, totalcount;
  double imba, pval;
  string genoty;
};

class class_snp
{  // Contains all the SNP data
public:
  unsigned num_hets, num_covg_hets, num_ref_bias, num_alt_bias;
  long int pose, gw_ini, gw_fin;
  double median_coverage, jointar, jointar_abs, fisher, fisher_pval, zvalue, zpvalue, zvalue_abs, zpvalue_abs;
  string chr, rsname, ref, alt, gw_chr, gw_type, gw_name, genes_overlap, genesymb_overlap, exon_overlap,
    imba_cons, sample_names;
  vector<int*> hets_readc_pvec;
  vector<double*> hets_imba_pvec, hets_pval_pvec;  // All het values with enough coverage (regardless of pval!)
  list<string> genesymb_list;
  vector<class_sampledata> sample_vec;

  class_snp() : fisher(-1), fisher_pval(-1), zvalue(-100), zpvalue(-1), zvalue_abs(-100), zpvalue_abs(-1),
    exon_overlap("none"), imba_cons("wat"), sample_names("none") { }

  void read( class_fstream& in );
  void calc_median_coverage();
  void load_median_info( map<double, pair<int,double> >& median_map, vector<double>& median_list );
  void load_shuffle_vec( vector<class_sampledata>& shuffle_vec );
  bool operator< ( const class_snp& s ) const;
};

class class_genotype
{  // Contains the info for each genotyped snp
public:
  string chr, rsname, ref, alt;
  long int pose;
  vector<string> genoty_vec;

  void read( class_fstream& in );
  void read_vcf( class_fstream& in );
  bool operator< ( const class_genotype& g ) const;
};










